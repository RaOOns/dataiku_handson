{
  "meta": {
    "label": "이미지 전처리 ver2",
    "description": "선택한 서브폴더의 이미지에 리사이즈/크롭/회전을 적용하여 출력 폴더에 저장합니다.",
    "icon": "icon-camera"
  },

  "kind": "PYTHON",

  "inputRoles": [
    {
      "name": "my_folder_input",
      "label": "입력 이미지 폴더",
      "description": "전처리할 이미지 폴더",
      "arity": "UNARY",
      "required": true,
      "acceptsDataset": false,
      "acceptsManagedFolder": true
    }
  ],

  "selectableFromFolder": "my_folder_input",

  "outputRoles": [
    {
      "name": "my_folder_output",
      "label": "출력 이미지 폴더",
      "description": "전처리가 완료된 이미지 폴더",
      "arity": "UNARY",
      "required": true,
      "acceptsDataset": false,
      "acceptsManagedFolder": true
    }
  ],

  "params": [
    {
      "name": "sep_compute",
      "label": "Compute",
      "type": "SEPARATOR"
    },
    {
      "name": "compute_device",
      "label": "실행 디바이스",
      "type": "SELECT",
      "defaultValue": "cpu",
      "selectChoices": [
        {"value": "cpu", "label": "CPU"},
        {"value": "gpu", "label": "GPU (CUDA, PyTorch+Kornia 필요)"}
      ],
      "description": "GPU를 선택하면 PyTorch+Kornia 기반 배치 처리로 가속합니다.환경에 CUDA가 없거나 PyTorch 설치가 없으면 자동으로 CPU로 폴백됩니다."
    },

    {
      "name": "gpu_batch_size",
      "label": "GPU 배치 크기",
      "type": "INT",
      "defaultValue": 16,
      "visibilityCondition": "model.compute_device == 'gpu'",
      "description": "여러 장을 한 번에 처리합니다. "
    },
      
    {
      "name": "sep_gpu",
      "label": " ※ 주의사항: Code Envs 및 Container를 확인하세요.",
      "type": "SEPARATOR",
      "visibilityCondition": "model.compute_device == 'gpu'",
      "description": ""
    },

    {
      "name": "sep1",
      "label": "Resize",
      "type": "SEPARATOR"
    },
    {
      "name": "apply_resize",
      "label": "리사이즈 적용",
      "type": "BOOLEAN",
      "defaultValue": true
    },
    {
      "name": "resize_width",
      "label": "리사이즈 가로(px)",
      "type": "INT",
      "defaultValue": 224,
      "visibilityCondition": "model.apply_resize"
    },
    {
      "name": "resize_height",
      "label": "리사이즈 세로(px)",
      "type": "INT",
      "defaultValue": 224,
      "visibilityCondition": "model.apply_resize"
    },

    {
      "name": "sep2",
      "label": "Crop",
      "type": "SEPARATOR"
    },
    {
      "name": "apply_crop",
      "label": "크롭 적용",
      "type": "BOOLEAN",
      "defaultValue": false
    },
    {
      "name": "crop_start",
      "label": "크롭 시작 좌표",
      "type": "STRING",
      "defaultValue": "0,0",
      "visibilityCondition": "model.apply_crop",
      "description": "형식: x,y"
    },
    {
      "name": "crop_range",
      "label": "크롭 범위",
      "type": "STRING",
      "defaultValue": "200, 200",
      "visibilityCondition": "model.apply_crop",
      "description": "형식: w,h (0 또는 음수면 시작점부터 끝까지로 처리)"
    },

    {
      "name": "sep3",
      "label": "Rotation",
      "type": "SEPARATOR"
    },
    {
      "name": "apply_rotate",
      "label": "회전 적용",
      "type": "BOOLEAN",
      "defaultValue": false
    },
    {
      "name": "rotate_deg",
      "label": "회전 각도(도)",
      "type": "DOUBLE",
      "defaultValue": 0.0,
      "visibilityCondition": "model.apply_rotate"
    }
  ]
}
